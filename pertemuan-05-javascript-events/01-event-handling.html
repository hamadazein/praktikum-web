<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JavaScript Events</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="../back-button.js" defer></script>
    <style>
      .demo-section {
        margin: 30px 0;
        padding: 25px;
        border: 2px solid #e9ecef;
        border-radius: 10px;
        background-color: #f8f9fa;
      }
      .event-demo {
        border: 2px dashed #007bff;
        padding: 20px;
        margin: 15px 0;
        border-radius: 8px;
        background-color: white;
        transition: all 0.3s ease;
      }
      .code-block {
        background-color: #f4f4f4;
        padding: 15px;
        border-radius: 5px;
        margin: 15px 0;
        font-family: "Courier New", monospace;
        border-left: 4px solid #007bff;
        font-size: 14px;
      }
      .output-box {
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
        border-radius: 5px;
        padding: 15px;
        margin: 10px 0;
        font-family: monospace;
      }
      .draggable-item {
        background-color: #007bff;
        color: white;
        padding: 10px;
        margin: 5px;
        border-radius: 5px;
        cursor: move;
        user-select: none;
      }
      .drop-zone {
        border: 2px dashed #6c757d;
        padding: 20px;
        margin: 10px;
        border-radius: 5px;
        min-height: 100px;
        background-color: #f8f9fa;
      }
      .drop-zone.drag-over {
        border-color: #007bff;
        background-color: #e3f2fd;
      }
      .resizable-box {
        background-color: #28a745;
        color: white;
        padding: 20px;
        border-radius: 5px;
        resize: both;
        overflow: auto;
        min-width: 200px;
        min-height: 100px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="text-center py-4 mb-4">
        <h1 class="display-4 text-primary">JavaScript Events</h1>
        <p class="lead">Menangani interaksi pengguna dengan event handling</p>
      </header>

      <!-- MOUSE EVENTS -->
      <section class="demo-section">
        <h2 class="text-primary mb-4">üñ±Ô∏è Mouse Events</h2>

        <div class="alert alert-info mb-4">
          <h5><i class="fas fa-info-circle me-2"></i>Apa itu Mouse Events?</h5>
          <p class="mb-0">
            Mouse events adalah kejadian yang dipicu oleh interaksi mouse
            seperti klik, hover, drag, dll. Event ini memungkinkan website
            merespons aksi pengguna secara real-time.
          </p>
        </div>

        <div class="row">
          <div class="col-md-6">
            <h4>Event Mouse Dasar</h4>
            <div class="event-demo text-center" id="mouseDemo">
              <h5>Hover, Klik, atau Double-klik saya!</h5>
              <p class="mb-0">Status: <span id="mouseStatus">Siap</span></p>
            </div>

            <div class="code-block">
              <h6>üí° Cara Kerja Mouse Events:</h6>
              <p>
                ‚Ä¢ click - Dipicu saat elemen diklik<br />
                ‚Ä¢ mouseover - Dipicu saat mouse masuk ke area elemen<br />
                ‚Ä¢ mouseout - Dipicu saat mouse keluar dari area elemen
              </p>

              element.addEventListener('click', function(e) {
              console.log('Diklik!', e); });
              element.addEventListener('mouseover', function(e) {
              console.log('Mouse masuk!'); });
              element.addEventListener('mouseout', function(e) {
              console.log('Mouse out!'); });
            </div>
          </div>

          <div class="col-md-6">
            <h4>Mouse Position Tracking</h4>
            <div
              class="event-demo"
              id="mousePosDemo"
              style="height: 150px; position: relative"
            >
              <div class="text-center pt-4">
                <p>Mouse Position:</p>
                <p id="mousePosition">X: 0, Y: 0</p>
              </div>
              <div
                id="mousePointer"
                style="
                  position: absolute;
                  width: 10px;
                  height: 10px;
                  background: red;
                  border-radius: 50%;
                  display: none;
                "
              ></div>
            </div>

            <div class="code-block">
              element.addEventListener('mousemove', function(e) { const rect =
              element.getBoundingClientRect(); const x = e.clientX - rect.left;
              const y = e.clientY - rect.top; console.log(`X: ${x}, Y: ${y}`);
              });
            </div>
          </div>
        </div>
      </section>

      <!-- KEYBOARD EVENTS -->
      <section class="demo-section">
        <h2 class="text-primary mb-4">‚å®Ô∏è Keyboard Events</h2>

        <div class="row">
          <div class="col-md-6">
            <h4>Key Press Detection</h4>
            <input
              type="text"
              class="form-control mb-3"
              id="keyDemo"
              placeholder="Type something..."
            />
            <div class="output-box" id="keyOutput">
              <strong>Key Info:</strong><br />
              Key: <span id="lastKey">-</span><br />
              KeyCode: <span id="lastKeyCode">-</span><br />
              Special Keys: <span id="specialKeys">-</span>
            </div>

            <div class="code-block">
              input.addEventListener('keydown', function(e) {
              console.log('Key:', e.key); console.log('KeyCode:', e.keyCode);
              console.log('Ctrl:', e.ctrlKey); console.log('Shift:',
              e.shiftKey); console.log('Alt:', e.altKey); });
            </div>
          </div>

          <div class="col-md-6">
            <h4>Keyboard Shortcuts</h4>
            <div class="event-demo">
              <p><strong>Coba shortcut ini:</strong></p>
              <ul>
                <li><kbd>Ctrl + S</kbd> - Save</li>
                <li><kbd>Ctrl + Z</kbd> - Undo</li>
                <li><kbd>Escape</kbd> - Cancel</li>
                <li><kbd>Enter</kbd> - Submit</li>
              </ul>
              <div class="output-box" id="shortcutOutput">
                Tekan shortcut untuk melihat hasil...
              </div>
            </div>

            <div class="code-block">
              document.addEventListener('keydown', function(e) { if (e.ctrlKey
              && e.key === 's') { e.preventDefault(); console.log('Save shortcut
              triggered!'); } if (e.key === 'Escape') { console.log('Cancel
              action!'); } });
            </div>
          </div>
        </div>
      </section>

      <!-- FORM EVENTS -->
      <section class="demo-section">
        <h2 class="text-primary mb-4">üìù Form Events</h2>

        <div class="alert alert-success mb-4">
          <h5>
            <i class="fas fa-check-circle me-2"></i>Mengapa Form Events Penting?
          </h5>
          <p class="mb-0">
            Form events memungkinkan validasi real-time, user experience yang
            lebih baik, dan kontrol penuh atas data yang dimasukkan pengguna
            sebelum dikirim ke server.
          </p>
        </div>

        <div class="row">
          <div class="col-md-6">
            <h4>Validasi Form</h4>
            <form id="demoForm" novalidate>
              <div class="mb-3">
                <label for="userName" class="form-label">Nama Pengguna</label>
                <input
                  type="text"
                  class="form-control"
                  id="userName"
                  required
                />
                <div class="invalid-feedback" id="userNameFeedback"></div>
              </div>

              <div class="mb-3">
                <label for="userEmail" class="form-label">Email</label>
                <input
                  type="email"
                  class="form-control"
                  id="userEmail"
                  required
                />
                <div class="invalid-feedback" id="userEmailFeedback"></div>
              </div>

              <div class="mb-3">
                <label for="userAge" class="form-label">Umur</label>
                <input
                  type="number"
                  class="form-control"
                  id="userAge"
                  min="18"
                  max="100"
                />
                <div class="invalid-feedback" id="userAgeFeedback"></div>
              </div>

              <button type="submit" class="btn btn-primary">Kirim</button>
              <button type="reset" class="btn btn-secondary">Reset</button>
            </form>

            <div
              class="output-box mt-3"
              id="formOutput"
              style="display: none"
            ></div>
          </div>

          <div class="col-md-6">
            <h4>Input Events</h4>
            <div class="mb-3">
              <label for="liveInput" class="form-label"
                >Live Input (oninput)</label
              >
              <input
                type="text"
                class="form-control"
                id="liveInput"
                placeholder="Ketik untuk melihat feedback real-time"
              />
              <small class="form-text text-muted"
                >Karakter: <span id="charCount">0</span></small
              >
            </div>

            <div class="mb-3">
              <label for="focusInput" class="form-label">Demo Focus/Blur</label>
              <input
                type="text"
                class="form-control"
                id="focusInput"
                placeholder="Klik untuk fokus"
              />
              <div class="output-box mt-2" id="focusOutput">
                Status: Tidak fokus
              </div>
            </div>

            <div class="code-block">
              // Input event (real-time) input.addEventListener('input',
              function(e) { console.log('Current value:', e.target.value); });
              // Change event (when focus lost) input.addEventListener('change',
              function(e) { console.log('Value changed:', e.target.value); });
              // Focus events input.addEventListener('focus', function(e) {
              console.log('Input focused'); });
            </div>
          </div>
        </div>
      </section>

      <!-- WINDOW EVENTS -->
      <section class="demo-section">
        <h2 class="text-primary mb-4">ü™ü Window Events</h2>

        <div class="row">
          <div class="col-md-6">
            <h4>Window Resize & Scroll</h4>
            <div class="event-demo">
              <p><strong>Window Info:</strong></p>
              <p>Width: <span id="windowWidth">0</span>px</p>
              <p>Height: <span id="windowHeight">0</span>px</p>
              <p>Scroll Y: <span id="scrollY">0</span>px</p>
            </div>

            <div class="code-block">
              window.addEventListener('resize', function(e) {
              console.log('Window resized:', window.innerWidth, 'x',
              window.innerHeight); }); window.addEventListener('scroll',
              function(e) { console.log('Scroll position:', window.scrollY); });
            </div>
          </div>

          <div class="col-md-6">
            <h4>Page Lifecycle</h4>
            <div class="event-demo">
              <button class="btn btn-warning" onclick="testBeforeUnload()">
                Test Before Unload
              </button>
              <button class="btn btn-info" onclick="showVisibilityState()">
                Check Visibility
              </button>
              <div class="output-box mt-3" id="lifecycleOutput">
                Page loaded at: <span id="loadTime"></span>
              </div>
            </div>

            <div class="code-block">
              // Page loaded window.addEventListener('load', function() {
              console.log('Page fully loaded'); }); // Before page unload
              window.addEventListener('beforeunload', function(e) {
              e.preventDefault(); e.returnValue = ''; }); // Visibility change
              document.addEventListener('visibilitychange', function() { if
              (document.hidden) { console.log('Page hidden'); } else {
              console.log('Page visible'); } });
            </div>
          </div>
        </div>
      </section>

      <!-- CUSTOM EVENTS -->
      <section class="demo-section">
        <h2 class="text-primary mb-4">üéØ Custom Events</h2>

        <div class="row">
          <div class="col-md-6">
            <h4>Creating Custom Events</h4>
            <button class="btn btn-success" id="customEventBtn">
              Trigger Custom Event
            </button>
            <button class="btn btn-primary" id="dataEventBtn">
              Trigger Event with Data
            </button>

            <div class="output-box mt-3" id="customEventOutput">
              Custom events will appear here...
            </div>

            <div class="code-block">
              // Create custom event const customEvent = new
              CustomEvent('myEvent', { detail: { message: 'Hello from custom
              event!' } }); // Listen for custom event
              document.addEventListener('myEvent', function(e) {
              console.log('Custom event triggered:', e.detail); }); // Dispatch
              event document.dispatchEvent(customEvent);
            </div>
          </div>

          <div class="col-md-6">
            <h4>Event Communication</h4>
            <div class="mb-3">
              <input
                type="text"
                class="form-control"
                id="messageInput"
                placeholder="Type a message"
              />
              <button class="btn btn-info mt-2" id="broadcastBtn">
                Broadcast Message
              </button>
            </div>

            <div class="row">
              <div class="col-6">
                <div class="event-demo" id="receiver1">
                  <h6>Receiver 1</h6>
                  <div id="messages1">No messages</div>
                </div>
              </div>
              <div class="col-6">
                <div class="event-demo" id="receiver2">
                  <h6>Receiver 2</h6>
                  <div id="messages2">No messages</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- DRAG AND DROP -->
      <section class="demo-section">
        <h2 class="text-primary mb-4">üñ±Ô∏è Drag and Drop Events</h2>

        <div class="alert alert-warning mb-4">
          <h5><i class="fas fa-hand-rock me-2"></i>Drag and Drop pada Web</h5>
          <p class="mb-0">
            Drag and Drop memungkinkan pengguna memindahkan elemen dengan cara
            yang intuitif. Fitur ini sangat berguna untuk file upload,
            reordering list, dan dashboard interaktif.
          </p>
        </div>

        <div class="row">
          <div class="col-md-6">
            <h4>Item yang Bisa Di-drag</h4>
            <div class="draggable-item" draggable="true" id="item1">
              üìÑ Dokumen 1
            </div>
            <div class="draggable-item" draggable="true" id="item2">
              üñºÔ∏è Gambar 2
            </div>
            <div class="draggable-item" draggable="true" id="item3">
              üìä Grafik 3
            </div>
          </div>

          <div class="col-md-6">
            <h4>Area Drop</h4>
            <div class="drop-zone" id="dropZone1">
              <strong>Folder A</strong><br />
              Taruh item di sini
            </div>
            <div class="drop-zone" id="dropZone2">
              <strong>Folder B</strong><br />
              Taruh item di sini
            </div>

            <div class="output-box" id="dropOutput">
              Aksi drag and drop akan muncul di sini...
            </div>
          </div>
        </div>

        <div class="code-block">
          // Make element draggable element.draggable = true;
          element.addEventListener('dragstart', function(e) {
          e.dataTransfer.setData('text/plain', element.id); console.log('Drag
          started'); }); // Drop zone events
          dropZone.addEventListener('dragover', function(e) {
          e.preventDefault(); // Allow drop });
          dropZone.addEventListener('drop', function(e) { e.preventDefault();
          const data = e.dataTransfer.getData('text/plain');
          console.log('Dropped:', data); });
        </div>
      </section>

      <!-- EVENT DELEGATION -->
      <section class="demo-section">
        <h2 class="text-primary mb-4">üéõÔ∏è Event Delegation</h2>

        <div class="alert alert-primary mb-4">
          <h5><i class="fas fa-sitemap me-2"></i>Apa itu Event Delegation?</h5>
          <p class="mb-0">
            Event Delegation adalah teknik menangani event pada elemen parent
            untuk elemen child yang dinamis. Ini sangat efisien untuk elemen
            yang ditambah/hapus secara dinamis.
          </p>
        </div>

        <div class="row">
          <div class="col-md-6">
            <h4>List Dinamis dengan Event Delegation</h4>
            <button class="btn btn-success" id="addItemBtn">Tambah Item</button>
            <ul class="list-group mt-3" id="dynamicList">
              <li
                class="list-group-item d-flex justify-content-between align-items-center"
              >
                Item 1
                <button class="btn btn-sm btn-danger delete-btn">Hapus</button>
              </li>
              <li
                class="list-group-item d-flex justify-content-between align-items-center"
              >
                Item 2
                <button class="btn btn-sm btn-danger delete-btn">Hapus</button>
              </li>
            </ul>
          </div>

          <div class="col-md-6">
            <h4>Grid Tombol dengan Delegation</h4>
            <div
              id="buttonGrid"
              class="d-grid gap-2"
              style="grid-template-columns: repeat(3, 1fr)"
            >
              <button class="btn btn-outline-primary grid-btn" data-value="1">
                1
              </button>
              <button class="btn btn-outline-primary grid-btn" data-value="2">
                2
              </button>
              <button class="btn btn-outline-primary grid-btn" data-value="3">
                3
              </button>
              <button class="btn btn-outline-primary grid-btn" data-value="4">
                4
              </button>
              <button class="btn btn-outline-primary grid-btn" data-value="5">
                5
              </button>
              <button class="btn btn-outline-primary grid-btn" data-value="6">
                6
              </button>
            </div>

            <div class="output-box mt-3" id="gridOutput">
              Clicked values: <span id="clickedValues">None</span>
            </div>
          </div>
        </div>

        <div class="code-block">
          // Event delegation - listen on parent element
          parentElement.addEventListener('click', function(e) { // Check if
          clicked element matches our selector if
          (e.target.matches('.delete-btn')) { console.log('Delete button
          clicked'); e.target.closest('li').remove(); } if
          (e.target.matches('.grid-btn')) { console.log('Grid button clicked:',
          e.target.dataset.value); } });
        </div>
      </section>

      <!-- PERFORMANCE OPTIMIZATION -->
      <section class="demo-section">
        <h2 class="text-primary mb-4">‚ö° Event Performance</h2>

        <div class="row">
          <div class="col-md-6">
            <h4>Throttling & Debouncing</h4>
            <input
              type="text"
              class="form-control mb-2"
              id="searchInput"
              placeholder="Search (debounced)"
            />
            <div class="resizable-box mb-3" id="resizableBox">
              Resize me to see throttled events!
            </div>

            <div class="output-box" id="performanceOutput">
              <div>Search calls: <span id="searchCalls">0</span></div>
              <div>Resize calls: <span id="resizeCalls">0</span></div>
            </div>
          </div>

          <div class="col-md-6">
            <h4>Event Cleanup</h4>
            <button class="btn btn-success" id="addListenerBtn">
              Add Event Listener
            </button>
            <button class="btn btn-danger" id="removeListenerBtn">
              Remove Event Listener
            </button>
            <button class="btn btn-info" id="testListenerBtn">
              Test Event
            </button>

            <div class="output-box mt-3" id="cleanupOutput">
              Event listener status:
              <span id="listenerStatus">Not attached</span>
            </div>

            <div class="code-block">
              // Debounce function function debounce(func, wait) { let timeout;
              return function executedFunction(...args) { const later = () => {
              clearTimeout(timeout); func(...args); }; clearTimeout(timeout);
              timeout = setTimeout(later, wait); }; } // Throttle function
              function throttle(func, wait) { let inThrottle; return function()
              { if (!inThrottle) { func.apply(this, arguments); inThrottle =
              true; setTimeout(() => inThrottle = false, wait); } } }
            </div>
          </div>
        </div>
      </section>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // =============================================================================
      // MOUSE EVENTS
      // =============================================================================
      const mouseDemo = document.getElementById("mouseDemo");
      const mouseStatus = document.getElementById("mouseStatus");
      const mousePosDemo = document.getElementById("mousePosDemo");
      const mousePosition = document.getElementById("mousePosition");
      const mousePointer = document.getElementById("mousePointer");

      mouseDemo.addEventListener("click", function () {
        mouseStatus.textContent = "Clicked!";
        this.style.backgroundColor = "#007bff";
        this.style.color = "white";
      });

      mouseDemo.addEventListener("dblclick", function () {
        mouseStatus.textContent = "Double clicked!";
        this.style.backgroundColor = "#28a745";
      });

      mouseDemo.addEventListener("mouseover", function () {
        if (mouseStatus.textContent === "Ready") {
          mouseStatus.textContent = "Mouse over";
        }
        this.style.backgroundColor = "#ffc107";
      });

      mouseDemo.addEventListener("mouseout", function () {
        if (mouseStatus.textContent === "Mouse over") {
          mouseStatus.textContent = "Mouse out";
          this.style.backgroundColor = "";
          this.style.color = "";
        }
      });

      mousePosDemo.addEventListener("mousemove", function (e) {
        const rect = this.getBoundingClientRect();
        const x = Math.round(e.clientX - rect.left);
        const y = Math.round(e.clientY - rect.top);

        mousePosition.textContent = `X: ${x}, Y: ${y}`;

        mousePointer.style.left = x - 5 + "px";
        mousePointer.style.top = y - 5 + "px";
        mousePointer.style.display = "block";
      });

      mousePosDemo.addEventListener("mouseleave", function () {
        mousePointer.style.display = "none";
      });

      // =============================================================================
      // KEYBOARD EVENTS
      // =============================================================================
      const keyDemo = document.getElementById("keyDemo");
      const lastKey = document.getElementById("lastKey");
      const lastKeyCode = document.getElementById("lastKeyCode");
      const specialKeys = document.getElementById("specialKeys");
      const shortcutOutput = document.getElementById("shortcutOutput");

      keyDemo.addEventListener("keydown", function (e) {
        lastKey.textContent = e.key;
        lastKeyCode.textContent = e.keyCode || e.which;

        let special = [];
        if (e.ctrlKey) special.push("Ctrl");
        if (e.shiftKey) special.push("Shift");
        if (e.altKey) special.push("Alt");

        specialKeys.textContent =
          special.length > 0 ? special.join(" + ") : "None";
      });

      document.addEventListener("keydown", function (e) {
        if (e.ctrlKey && e.key === "s") {
          e.preventDefault();
          shortcutOutput.innerHTML =
            '<strong style="color: green;">Save action triggered!</strong>';
        } else if (e.ctrlKey && e.key === "z") {
          e.preventDefault();
          shortcutOutput.innerHTML =
            '<strong style="color: blue;">Undo action triggered!</strong>';
        } else if (e.key === "Escape") {
          shortcutOutput.innerHTML =
            '<strong style="color: red;">Cancel action triggered!</strong>';
        } else if (e.key === "Enter" && document.activeElement === keyDemo) {
          shortcutOutput.innerHTML =
            '<strong style="color: purple;">Submit action triggered!</strong>';
        }
      });

      // =============================================================================
      // FORM EVENTS
      // =============================================================================
      const demoForm = document.getElementById("demoForm");
      const formOutput = document.getElementById("formOutput");

      demoForm.addEventListener("submit", function (e) {
        e.preventDefault();

        const userName = document.getElementById("userName");
        const userEmail = document.getElementById("userEmail");
        const userAge = document.getElementById("userAge");

        let isValid = true;

        // Validate username
        if (userName.value.length < 3) {
          userName.classList.add("is-invalid");
          document.getElementById("userNameFeedback").textContent =
            "Username must be at least 3 characters";
          isValid = false;
        } else {
          userName.classList.remove("is-invalid");
          userName.classList.add("is-valid");
        }

        // Validate email
        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailPattern.test(userEmail.value)) {
          userEmail.classList.add("is-invalid");
          document.getElementById("userEmailFeedback").textContent =
            "Please enter a valid email";
          isValid = false;
        } else {
          userEmail.classList.remove("is-invalid");
          userEmail.classList.add("is-valid");
        }

        // Validate age
        if (userAge.value && (userAge.value < 18 || userAge.value > 100)) {
          userAge.classList.add("is-invalid");
          document.getElementById("userAgeFeedback").textContent =
            "Age must be between 18 and 100";
          isValid = false;
        } else {
          userAge.classList.remove("is-invalid");
          userAge.classList.add("is-valid");
        }

        if (isValid) {
          formOutput.innerHTML = `
                    <strong>Form submitted successfully!</strong><br>
                    Username: ${userName.value}<br>
                    Email: ${userEmail.value}<br>
                    Age: ${userAge.value || "Not specified"}
                `;
          formOutput.style.display = "block";
          formOutput.style.backgroundColor = "#d4edda";
          formOutput.style.borderColor = "#c3e6cb";
        } else {
          formOutput.innerHTML =
            '<strong style="color: red;">Please fix the errors above</strong>';
          formOutput.style.display = "block";
          formOutput.style.backgroundColor = "#f8d7da";
          formOutput.style.borderColor = "#f5c6cb";
        }
      });

      demoForm.addEventListener("reset", function () {
        // Clear validation classes
        const inputs = this.querySelectorAll(".form-control");
        inputs.forEach((input) => {
          input.classList.remove("is-valid", "is-invalid");
        });
        formOutput.style.display = "none";
      });

      // Live input events
      const liveInput = document.getElementById("liveInput");
      const charCount = document.getElementById("charCount");

      liveInput.addEventListener("input", function () {
        charCount.textContent = this.value.length;
      });

      // Focus events
      const focusInput = document.getElementById("focusInput");
      const focusOutput = document.getElementById("focusOutput");

      focusInput.addEventListener("focus", function () {
        focusOutput.textContent = "Status: Focused";
        focusOutput.style.backgroundColor = "#d1ecf1";
        this.style.borderColor = "#007bff";
      });

      focusInput.addEventListener("blur", function () {
        focusOutput.textContent = "Status: Not focused";
        focusOutput.style.backgroundColor = "#d4edda";
        this.style.borderColor = "";
      });

      // =============================================================================
      // WINDOW EVENTS
      // =============================================================================
      const windowWidth = document.getElementById("windowWidth");
      const windowHeight = document.getElementById("windowHeight");
      const scrollY = document.getElementById("scrollY");
      const loadTime = document.getElementById("loadTime");

      function updateWindowInfo() {
        windowWidth.textContent = window.innerWidth;
        windowHeight.textContent = window.innerHeight;
        scrollY.textContent = Math.round(window.scrollY);
      }

      window.addEventListener("resize", updateWindowInfo);
      window.addEventListener("scroll", updateWindowInfo);
      window.addEventListener("load", function () {
        loadTime.textContent = new Date().toLocaleTimeString();
        updateWindowInfo();
      });

      function testBeforeUnload() {
        window.addEventListener("beforeunload", function (e) {
          e.preventDefault();
          e.returnValue = "";
        });
        alert(
          "Before unload event attached! Try to refresh or close the page."
        );
      }

      function showVisibilityState() {
        const state = document.hidden ? "Hidden" : "Visible";
        alert(`Page is currently: ${state}`);
      }

      // =============================================================================
      // CUSTOM EVENTS
      // =============================================================================
      const customEventBtn = document.getElementById("customEventBtn");
      const dataEventBtn = document.getElementById("dataEventBtn");
      const customEventOutput = document.getElementById("customEventOutput");

      // Listen for custom events
      document.addEventListener("myCustomEvent", function (e) {
        customEventOutput.innerHTML += `<div>Custom event triggered: ${e.detail.message}</div>`;
      });

      document.addEventListener("dataEvent", function (e) {
        customEventOutput.innerHTML += `<div>Data event: ${JSON.stringify(
          e.detail
        )}</div>`;
      });

      customEventBtn.addEventListener("click", function () {
        const customEvent = new CustomEvent("myCustomEvent", {
          detail: { message: "Hello from custom event!" },
        });
        document.dispatchEvent(customEvent);
      });

      dataEventBtn.addEventListener("click", function () {
        const dataEvent = new CustomEvent("dataEvent", {
          detail: {
            timestamp: new Date().toISOString(),
            user: "Demo User",
            action: "button_click",
          },
        });
        document.dispatchEvent(dataEvent);
      });

      // Event communication
      const messageInput = document.getElementById("messageInput");
      const broadcastBtn = document.getElementById("broadcastBtn");
      const messages1 = document.getElementById("messages1");
      const messages2 = document.getElementById("messages2");

      document.addEventListener("broadcast", function (e) {
        const message = `[${new Date().toLocaleTimeString()}] ${
          e.detail.message
        }`;
        messages1.innerHTML = message;
        messages2.innerHTML = message;
      });

      broadcastBtn.addEventListener("click", function () {
        if (messageInput.value.trim()) {
          const broadcastEvent = new CustomEvent("broadcast", {
            detail: { message: messageInput.value },
          });
          document.dispatchEvent(broadcastEvent);
          messageInput.value = "";
        }
      });

      // =============================================================================
      // DRAG AND DROP
      // =============================================================================
      const draggableItems = document.querySelectorAll(".draggable-item");
      const dropZones = document.querySelectorAll(".drop-zone");
      const dropOutput = document.getElementById("dropOutput");

      draggableItems.forEach((item) => {
        item.addEventListener("dragstart", function (e) {
          e.dataTransfer.setData("text/plain", this.id);
          e.dataTransfer.setData("text/html", this.outerHTML);
          dropOutput.innerHTML += `<div>Started dragging: ${this.textContent}</div>`;
        });
      });

      dropZones.forEach((zone) => {
        zone.addEventListener("dragover", function (e) {
          e.preventDefault();
          this.classList.add("drag-over");
        });

        zone.addEventListener("dragleave", function (e) {
          this.classList.remove("drag-over");
        });

        zone.addEventListener("drop", function (e) {
          e.preventDefault();
          this.classList.remove("drag-over");

          const data = e.dataTransfer.getData("text/plain");
          const draggedElement = document.getElementById(data);

          if (draggedElement) {
            this.appendChild(draggedElement);
            dropOutput.innerHTML += `<div>Dropped ${
              draggedElement.textContent
            } in ${this.querySelector("strong").textContent}</div>`;
          }
        });
      });

      // =============================================================================
      // EVENT DELEGATION
      // =============================================================================
      const addItemBtn = document.getElementById("addItemBtn");
      const dynamicList = document.getElementById("dynamicList");
      let itemCounter = 3;

      // Event delegation for dynamic list
      dynamicList.addEventListener("click", function (e) {
        if (e.target.matches(".delete-btn")) {
          e.target.closest("li").remove();
        }
      });

      addItemBtn.addEventListener("click", function () {
        const newItem = document.createElement("li");
        newItem.className =
          "list-group-item d-flex justify-content-between align-items-center";
        newItem.innerHTML = `
                Item ${itemCounter}
                <button class="btn btn-sm btn-danger delete-btn">Delete</button>
            `;
        dynamicList.appendChild(newItem);
        itemCounter++;
      });

      // Button grid delegation
      const buttonGrid = document.getElementById("buttonGrid");
      const clickedValues = document.getElementById("clickedValues");
      let values = [];

      buttonGrid.addEventListener("click", function (e) {
        if (e.target.matches(".grid-btn")) {
          const value = e.target.dataset.value;
          values.push(value);
          clickedValues.textContent = values.join(", ");

          e.target.classList.remove("btn-outline-primary");
          e.target.classList.add("btn-primary");
        }
      });

      // =============================================================================
      // PERFORMANCE OPTIMIZATION
      // =============================================================================
      let searchCalls = 0;
      let resizeCalls = 0;

      // Debounce function
      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // Throttle function
      function throttle(func, wait) {
        let inThrottle;
        return function () {
          if (!inThrottle) {
            func.apply(this, arguments);
            inThrottle = true;
            setTimeout(() => (inThrottle = false), wait);
          }
        };
      }

      const searchInput = document.getElementById("searchInput");
      const resizableBox = document.getElementById("resizableBox");

      const debouncedSearch = debounce(function (value) {
        searchCalls++;
        document.getElementById("searchCalls").textContent = searchCalls;
        console.log("Search for:", value);
      }, 300);

      searchInput.addEventListener("input", function (e) {
        debouncedSearch(e.target.value);
      });

      const throttledResize = throttle(function () {
        resizeCalls++;
        document.getElementById("resizeCalls").textContent = resizeCalls;
        console.log("Resize detected");
      }, 100);

      // Use ResizeObserver for element resize
      if (window.ResizeObserver) {
        const resizeObserver = new ResizeObserver(throttledResize);
        resizeObserver.observe(resizableBox);
      }

      // Event cleanup demo
      const addListenerBtn = document.getElementById("addListenerBtn");
      const removeListenerBtn = document.getElementById("removeListenerBtn");
      const testListenerBtn = document.getElementById("testListenerBtn");
      const listenerStatus = document.getElementById("listenerStatus");

      let eventHandler = function () {
        alert("Event listener is working!");
      };

      addListenerBtn.addEventListener("click", function () {
        testListenerBtn.addEventListener("click", eventHandler);
        listenerStatus.textContent = "Attached";
        listenerStatus.style.color = "green";
      });

      removeListenerBtn.addEventListener("click", function () {
        testListenerBtn.removeEventListener("click", eventHandler);
        listenerStatus.textContent = "Removed";
        listenerStatus.style.color = "red";
      });

      console.log("üéØ JavaScript Events tutorial loaded!");
      console.log(
        "Try interacting with different elements to see events in action."
      );
    </script>
  </body>
</html>
